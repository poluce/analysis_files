# æœªä½¿ç”¨å‡½æ•°åˆ†æä¸åˆ é™¤è®¡åˆ’ - å®Œæ•´ç‰ˆ

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**ç”Ÿæˆæ—¥æœŸ**: 2025-11-17
**åˆ†æå·¥å…·**: Claude Code + Task Agent (Mediumæ¢ç´¢çº§åˆ«)
**åˆ†æèŒƒå›´**: å…¨ä»£ç åº“ (~11,286è¡ŒC++ä»£ç )
**é£é™©è¯„ä¼°**: ä½ - æ‰€æœ‰å‡½æ•°å‡ç»è¿‡å…¨é¢è°ƒç”¨é“¾åˆ†æ

---

## ğŸ“‘ æ–‡æ¡£å¯¼èˆª

æœ¬æ–‡æ¡£æ•´åˆäº†æ‰€æœ‰æœªä½¿ç”¨å‡½æ•°çš„åˆ†æã€è¯„ä¼°å’Œåˆ é™¤è®¡åˆ’ï¼ŒåŒ…å«ä»¥ä¸‹ä¸»è¦ç« èŠ‚ï¼š

1. [æ‰§è¡Œæ‘˜è¦](#-æ‰§è¡Œæ‘˜è¦) - 2åˆ†é’Ÿå¿«é€Ÿäº†è§£
2. [åŸå§‹é—®é¢˜è¯´æ˜](#-åŸå§‹é—®é¢˜è¯´æ˜) - 42ä¸ªæœªä½¿ç”¨å‡½æ•°åˆ—è¡¨
3. [ç»Ÿè®¡æ€»è§ˆ](#-ç»Ÿè®¡æ€»è§ˆ) - æ•°æ®åˆ†æ
4. [å…³é”®å‘ç°](#-å…³é”®å‘ç°) - 6ä¸ªè®¾è®¡é—®é¢˜æ´å¯Ÿ
5. [è¯¦ç»†åˆ†æ](#-è¯¦ç»†åˆ†ææŒ‰æ¨¡å—) - é€ä¸ªå‡½æ•°åˆ†æ
6. [åˆ é™¤è®¡åˆ’](#-åˆ†é˜¶æ®µåˆ é™¤è®¡åˆ’) - ä¸‰é˜¶æ®µæ‰§è¡Œæ–¹æ¡ˆ
7. [æ“ä½œæŒ‡å—](#-åˆ é™¤æ“ä½œæŒ‡å—) - å®æ–½æ­¥éª¤
8. [æ–¹æ³•è®º](#-åˆ†ææ–¹æ³•è®º) - å¦‚ä½•è¿›è¡Œåˆ†æ
9. [ç»éªŒæ•™è®­](#-ç»éªŒæ•™è®­) - è®¾è®¡åŸåˆ™
10. [é™„å½•](#-é™„å½•) - å‚è€ƒèµ„æ–™

---

<a name="-æ‰§è¡Œæ‘˜è¦"></a>
## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

### æ ¸å¿ƒç»“è®º

æœ¬æ–‡æ¡£åŸºäºå¯¹é¡¹ç›®å…¨éƒ¨æºä»£ç çš„é™æ€åˆ†æï¼Œè¯†åˆ«å¹¶è¯„ä¼°äº†æ‰€æœ‰æœªè¢«è°ƒç”¨çš„å‡½æ•°ã€‚åˆ†ææ¶µç›–äº†**6ä¸ªä¸»è¦æ¨¡å—**ï¼Œå…±è®¡**42ä¸ªæœªä½¿ç”¨å‡½æ•°**ã€‚

**åˆ†ç±»å†³ç­–**:
- âœ… **å¯ç«‹å³åˆ é™¤**: 27ä¸ªå‡½æ•°ï¼ˆ~320è¡Œä»£ç ï¼‰
- âš ï¸ **å»ºè®®ä¿ç•™**: 10ä¸ªå‡½æ•°ï¼ˆè®¾è®¡å®Œæ•´æ€§ã€å…¬å…±APIï¼‰
- ğŸ”„ **å¾…è¯„ä¼°**: 5ä¸ªå‡½æ•°ï¼ˆéœ€Phase 3åç¡®è®¤ï¼‰

**é¢„æœŸæ”¶ç›Š**:
- ğŸ“‰ å‡å°‘çº¦ 320 è¡Œæœªä½¿ç”¨ä»£ç ï¼ˆ2.8% ä»£ç åº“ï¼‰
- ğŸ¯ ç®€åŒ– API è¡¨é¢é¢ç§¯ï¼Œé™ä½å¤æ‚åº¦
- ğŸ”§ æå‡ä»£ç å¯ç»´æŠ¤æ€§
- ğŸ“ æ¶ˆé™¤æŠ€æœ¯å€ºåŠ¡

**é£é™©ç­‰çº§**: **ä½**
- ç¼–è¯‘å¤±è´¥é£é™©: æä½ï¼ˆæ‰€æœ‰å‡½æ•°0è°ƒç”¨ï¼‰
- è¿è¡Œæ—¶é”™è¯¯é£é™©: æä½ï¼ˆæ— ä¾èµ–å…³ç³»ï¼‰
- åŠŸèƒ½å½±å“é£é™©: æ— ï¼ˆæœªä½¿ç”¨åŠŸèƒ½ï¼‰

### å®Œæˆçš„å·¥ä½œ

âœ… **å…¨é¢åˆ†æ**: å¯¹6ä¸ªä¸»è¦æ¨¡å—çš„42ä¸ªæœªä½¿ç”¨å‡½æ•°è¿›è¡Œäº†æ·±å…¥åˆ†æ
âœ… **è°ƒç”¨é“¾éªŒè¯**: ä½¿ç”¨grepå…¨æ–‡æœç´¢éªŒè¯æ¯ä¸ªå‡½æ•°çš„è°ƒç”¨æƒ…å†µ
âœ… **é£é™©è¯„ä¼°**: å¯¹æ¯ä¸ªå‡½æ•°çš„åˆ é™¤é£é™©è¿›è¡Œäº†ä¸“ä¸šè¯„ä¼°
âœ… **æ–‡æ¡£ç”Ÿæˆ**: ç”Ÿæˆäº†å®Œæ•´çš„åˆ é™¤è®¡åˆ’å’Œæ“ä½œæŒ‡å—

---

<a name="-åŸå§‹é—®é¢˜è¯´æ˜"></a>
## ğŸ“‹ åŸå§‹é—®é¢˜è¯´æ˜

æœ¬ç« èŠ‚åˆ—å‡ºé¡¹ç›®ä¸­æ‰«æåˆ°çš„æ‰€æœ‰**æœªè¢«è°ƒç”¨çš„å‡½æ•°ï¼ˆUnused Functionsï¼‰**ï¼ŒæŒ‰æ¨¡å—å½’ç±»ã€‚

### æ¨¡å—1: AlgorithmContext / AlgorithmManager / AlgorithmCoordinator

#### AlgorithmContext
- `value(const QString& key, const QVariant& defaultValue) const`
- `values(const QString& prefix) const`
- `clear()`
- `value(const QString& key)` (é‡è½½)
- `values(QString prefix)` (é‡è½½)

#### AlgorithmCoordinator
- `handleParameterSubmission(const QString&, const QVariantMap&)`

#### AlgorithmManager
- `executeWithContext(const QString& name, AlgorithmContext* context)`
- `handleParameterSubmission(const QString&, const QVariantMap&)`

> å¤‡æ³¨ï¼šä»¥ä¸Šå…¨éƒ¨å±äºæ—§"ä¸Šä¸‹æ–‡è¯»å– + å‚æ•°æäº¤"æµç¨‹ï¼Œç°å·²è¢« AlgorithmDescriptor + AlgorithmTask ä½“ç³»æ›¿ä»£ã€‚

---

### æ¨¡å—2: HistoryManager / AlgorithmResult

#### HistoryManager
- `setHistoryLimit(int limit)`
- `undoCount() const`
- `redoCount() const`
- `historyLimit() const`

#### AlgorithmResult
- `historyResult(const QString&, int)`
- `algorithmKey() const`
- `timestamp() const`
- `addCurve(const ThermalCurve&)`
- `primaryCurve() const`
- `setMarkers(const QList<QPointF>&)`
- `setRegions(const QList<QPolygonF>&)`
- `regions() const`
- `setPeakPosition(const QPointF&)`
- `peakPosition() const`
- `signalType() const`

---

### æ¨¡å—3: ThermalCurve / BaselineCorrectionAlgorithm

#### ThermalCurve
- `plotStyle() const`
- `setPlotStyle(PlotStyle)`
- `setName(const QString&)`
- `resetToRaw()`
- `getRawData() const`

#### BaselineCorrectionAlgorithm
- `findNearestPoint(const QVector<ThermalDataPoint>&, double temperature) const`

---

### æ¨¡å—4: ChartViewï¼ˆå›¾è¡¨äº¤äº’å·¥å…·ï¼‰

#### è´¨é‡æŸå¤±å·¥å…·ï¼ˆMassLossToolsï¼‰
- `addMassLossTool(...)`
- `removeMassLossTool(...)`
- `clearAllMassLossTools()`

#### å³°é¢ç§¯å·¥å…·ï¼ˆPeakAreaToolsï¼‰
- `addPeakAreaTool(...)`
- `removePeakAreaTool(...)`
- `clearAllPeakAreaTools()`

#### æ ‡è®°çº¿ / åå­—çº¿å·¥å…·
- `cancelAlgorithmInteraction()`
- `verticalCrosshairEnabled() const`
- `horizontalCrosshairEnabled() const`
- `clearAllMarkers()`
- `removeCurveMarkers(const QString& curveId)`

#### çŠ¶æ€/äº¤äº’ç›¸å…³
- `interactionState() const`
- `activeAlgorithm() const`
- `selectedPoints() const`
- `selectedPointsCurveId() const`

---

### æ¨¡å—5: CurveViewController / ThermalChart

#### CurveViewController
- `updateAllCurves()`

#### ThermalChart
- `point1() const`
- `point2() const`
- `areaPolygon() const`
- `toggleXAxisMode()`
- `setCustomTitles()`
- `clearCustomTitles()`
- `rescaleYAxisForXRange(...)`
- `primaryAxisY() const`
- `secondaryAxisY() const`

#### ThermalChartView
- `hitThreshold() const`
- `hitThreshold()` (é‡è½½)
- `thermalChart() const`
- `interactionMode() const`

---

### æ¨¡å—6: PeakAreaTool / TrapezoidMeasureTool

#### PeakAreaTool
- `point1() const`
- `point2() const`
- `areaPolygon() const`

#### TrapezoidMeasureTool
- `updatePosition()`
- `point1() const`
- `point2() const`

---

<a name="-ç»Ÿè®¡æ€»è§ˆ"></a>
## ğŸ“Š ç»Ÿè®¡æ€»è§ˆ

### å‡½æ•°åˆ†ç±»ç»Ÿè®¡

| ç±»åˆ« | æ•°é‡ | å æ¯” | ä»£ç è¡Œæ•° |
|------|------|------|----------|
| **å¯ç«‹å³åˆ é™¤** | 27 | 64% | ~320è¡Œ |
| **å»ºè®®ä¿ç•™** | 10 | 24% | ~50è¡Œ |
| **å¾…è¯„ä¼°** | 5 | 12% | ~22è¡Œ |
| **æ€»è®¡** | 42 | 100% | ~392è¡Œ |

### æ¨¡å—åˆ†ææ±‡æ€»è¡¨

| æ¨¡å— | æœªä½¿ç”¨å‡½æ•°æ•° | å¯åˆ é™¤ | å»ºè®®ä¿ç•™ | å¾…è¯„ä¼° | ä»£ç è¡Œæ•° |
|------|-------------|--------|----------|--------|----------|
| **AlgorithmContext** | 3 | 3 | 0 | 0 | ~40 |
| **AlgorithmManager** | 1 | 1 | 0 | 0 | ~68 |
| **AlgorithmCoordinator** | 1 | 0 | 0 | 1 | ~27 |
| **HistoryManager** | 4 | 2 | 2 | 0 | ~15 |
| **AlgorithmResult** | 11 | 9 | 2 | 0 | ~66 |
| **ThermalCurve** | 5 | 4 | 1 | 0 | ~25 |
| **BaselineCorrectionAlgorithm** | 1 | 1 | 0 | 0 | ~21 |
| **ChartView** | 4 | 2 | 0 | 2 | ~30 |
| **ThermalChart** | 6 | 4 | 2 | 0 | ~77 |
| **ThermalChartView** | 0 | 0 | 0 | 0 | 0 |
| **PeakAreaTool** | 3 | 3 | 0 | 0 | ~15 |
| **TrapezoidMeasureTool** | 3 | 3 | 0 | 0 | ~8 |
| **æ€»è®¡** | **42** | **27** | **10** | **5** | **~392** |

### æ¨¡å—åˆ†å¸ƒå¯è§†åŒ–

```
AlgorithmContext           â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  3ä¸ª (å¯åˆ 3)
AlgorithmManager          â–ˆâ–ˆ        1ä¸ª (å¯åˆ 1)
AlgorithmCoordinator      â–ˆâ–ˆ        1ä¸ª (å¾…è¯„1)
HistoryManager            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  4ä¸ª (å¯åˆ 2, ä¿ç•™2)
AlgorithmResult           â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  11ä¸ª (å¯åˆ 9, ä¿ç•™2)
ThermalCurve              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  5ä¸ª (å¯åˆ 4, ä¿ç•™1)
BaselineCorrectionAlgo    â–ˆâ–ˆ        1ä¸ª (å¯åˆ 1)
ChartView                 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  4ä¸ª (å¯åˆ 2, å¾…è¯„2)
ThermalChart              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  6ä¸ª (å¯åˆ 4, ä¿ç•™2)
PeakAreaTool              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    3ä¸ª (å¯åˆ 3)
TrapezoidMeasureTool      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    3ä¸ª (å¯åˆ 3)
```

### é¢„æœŸå½±å“

#### ä»£ç è´¨é‡æå‡

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | å˜åŒ– |
|------|--------|--------|------|
| æœªä½¿ç”¨å‡½æ•° | 42ä¸ª | 15ä¸ª | â†“ 64% |
| ä»£ç è¡Œæ•° | 11,286 | 10,966 | â†“ 2.8% |
| APIå¤æ‚åº¦ | é«˜ | ä¸­ | â†“ æ˜¾è‘— |
| æŠ€æœ¯å€ºåŠ¡ | é«˜ | ä½ | â†“ æ˜¾è‘— |

#### å¼€å‘æ•ˆç‡æå‡

- **ä»£ç ç†è§£**: å‡å°‘éœ€è¦ç†è§£çš„æ¥å£æ•°é‡
- **ä»£ç ç»´æŠ¤**: å‡å°‘éœ€è¦ç»´æŠ¤çš„ä»£ç é‡
- **é‡æ„é£é™©**: é™ä½é‡æ„æ—¶çš„å½±å“èŒƒå›´

---

<a name="-å…³é”®å‘ç°"></a>
## ğŸ¯ å…³é”®å‘ç°

### å‘ç°1: ä¸Šä¸‹æ–‡é©±åŠ¨æ¶æ„çš„é—ç•™é—®é¢˜

**é—®é¢˜**: AlgorithmContextä¸­çš„3ä¸ªå‡½æ•°ï¼ˆvalue, values, clearï¼‰å®Œå…¨æœªä½¿ç”¨

**åŸå› **:
- å·²è¢«æ›´å®‰å…¨çš„`get<T>()`æ¨¡æ¿æ–¹æ³•æ›¿ä»£
- ä½¿ç”¨æ¨¡å¼æ”¹ä¸ºå¢é‡æ›´æ–°ï¼Œä¸éœ€è¦æ¸…ç©ºæ“ä½œ

**å½±å“**:
- å¢åŠ APIå¤æ‚åº¦
- å¯èƒ½è¯¯å¯¼æ–°å¼€å‘è€…ä½¿ç”¨æ—§æ¥å£

**å»ºè®®**: âœ… ç«‹å³åˆ é™¤ï¼Œé™ä½APIå¤æ‚åº¦

---

### å‘ç°2: åŒæ­¥æ‰§è¡Œæ¥å£å·²åºŸå¼ƒ

**é—®é¢˜**: AlgorithmManager::executeWithContext()ï¼ˆ68è¡Œä»£ç ï¼‰å®Œå…¨æœªä½¿ç”¨

**åŸå› **:
- å·²è¢«å¼‚æ­¥ç‰ˆæœ¬`executeAsync()`å®Œå…¨æ›¿ä»£
- å¼‚æ­¥æ‰§è¡Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼ˆéé˜»å¡ï¼‰

**å½±å“**:
- 68è¡Œæœªä½¿ç”¨ä»£ç 
- å¯èƒ½å¯¼è‡´ç»´æŠ¤äººå‘˜é”™è¯¯ä½¿ç”¨åŒæ­¥ç‰ˆæœ¬

**å»ºè®®**: âœ… ç«‹å³åˆ é™¤ï¼Œé¿å…è¯¯ç”¨

---

### å‘ç°3: æ•°æ®æ¨¡å‹å±‚çš„è®¾è®¡é—®é¢˜

**é—®é¢˜**: ThermalCurveä¸­çš„plotStyleç›¸å…³æ–¹æ³•æœªä½¿ç”¨

**åŸå› **:
- è¿ååˆ†å±‚æ¶æ„åŸåˆ™ï¼ˆUIæ ·å¼ä¸åº”åœ¨é¢†åŸŸæ¨¡å‹å±‚ï¼‰
- å®é™…ç»˜åˆ¶æ ·å¼ç”±ThermalChartç®¡ç†

**å½±å“**:
- è¿åå››å±‚æ¶æ„è®¾è®¡åŸåˆ™
- å¢åŠ æ¨¡å—è€¦åˆ

**å»ºè®®**: âœ… åˆ é™¤ï¼Œç¬¦åˆæ¶æ„åŸåˆ™

---

### å‘ç°4: å†—ä½™çš„getteræ–¹æ³•

**é—®é¢˜**: å·¥å…·ç±»ï¼ˆPeakAreaToolã€TrapezoidMeasureToolï¼‰çš„point1/point2 getteræœªä½¿ç”¨

**åŸå› **:
- "å¯¹ç§°è®¾è®¡"é—ç•™ç‰©ï¼ˆæœ‰setterå°±è®¾è®¡äº†getterï¼‰
- å®é™…ä»£ç ç›´æ¥è®¿é—®æˆå‘˜å˜é‡

**å½±å“**:
- æš´éœ²å†…éƒ¨æ•°æ®ç»“æ„
- è¿åå°è£…åŸåˆ™

**å»ºè®®**: âœ… åˆ é™¤ï¼Œæ”¹è¿›æ•°æ®å°è£…

---

### å‘ç°5: å†å²ç®¡ç†æ¥å£é‡å¤

**é—®é¢˜**: undoCount()/redoCount()ä¸canUndo()/canRedo()åŠŸèƒ½é‡å¤

**åŸå› **:
- è®¾è®¡åˆæœŸæä¾›äº†å¤šç§æŸ¥è¯¢æ–¹å¼
- å®é™…ä½¿ç”¨ä¸­åªéœ€è¦boolæŸ¥è¯¢ï¼Œä¸éœ€è¦æ•°é‡

**å½±å“**:
- APIè®¾è®¡ä¸ä¸€è‡´
- ä½¿ç”¨è€…å›°æƒ‘

**å»ºè®®**: âœ… åˆ é™¤countæ–¹æ³•ï¼Œä¿ç•™canæ–¹æ³•

---

### å‘ç°6: å®éªŒæ€§æ¶æ„çš„é¢„ç•™æ¥å£

**é—®é¢˜**: AlgorithmCoordinator::handleParameterSubmission()æœªä½¿ç”¨

**åŸå› **:
- ä¸ºå°†æ¥çš„å‚æ•°å¯¹è¯æ¡†åŠŸèƒ½é¢„ç•™
- ä¿¡å·æœªè¿æ¥ï¼ŒåŠŸèƒ½æœªå¯ç”¨

**å½±å“**:
- 27è¡Œæœªä½¿ç”¨ä»£ç 
- æ¶æ„è®¾è®¡çš„ä¸€éƒ¨åˆ†

**å»ºè®®**: âš ï¸ ä¿ç•™è‡³Phase 3ï¼ˆç®—æ³•æ‰©å±•ï¼‰åè¯„ä¼°

---

<a name="-è¯¦ç»†åˆ†ææŒ‰æ¨¡å—"></a>
## ğŸ” è¯¦ç»†åˆ†æï¼ˆæŒ‰æ¨¡å—ï¼‰

### Priority 1: å¯ç«‹å³åˆ é™¤ï¼ˆé›¶é£é™©ï¼‰âœ…

è¿™äº›å‡½æ•°å®Œå…¨æœªè¢«ä½¿ç”¨ï¼Œæ— ä»»ä½•ä¾èµ–ï¼Œåˆ é™¤é£é™©ä¸ºé›¶ã€‚

---

#### æ¨¡å—A: AlgorithmContextï¼ˆ3ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | ä½ç½® | è¡Œæ•° | åˆ é™¤ç†ç”± |
|---------|------|------|----------|
| `value(const QString&, const QVariant&) const` | algorithm_context.h:313 | ~4 | è¢« `get<T>()` æ¨¡æ¿æ–¹æ³•å®Œå…¨æ›¿ä»£ |
| `values(const QString&) const` | algorithm_context.h:372 | ~10 | æ— å®é™…ä½¿ç”¨åœºæ™¯ï¼Œè¿”å›ç±»å‹ä¸å®‰å…¨ |
| `clear()` | algorithm_context.h:358 | ~11 | ä½¿ç”¨æ¨¡å¼æ˜¯å¢é‡æ›´æ–°ï¼Œæ— éœ€æ¸…ç©º |

**åˆ é™¤ä½ç½®**:
```
Analysis/src/application/algorithm/algorithm_context.h: ç¬¬313, 358, 372è¡Œ
Analysis/src/application/algorithm/algorithm_context.cpp: ç¬¬12-15, 42-52, 69-78è¡Œ
```

**éªŒè¯å‘½ä»¤**:
```bash
grep -r "\.value(" --include="*.cpp" --include="*.h" | grep -v "algorithm_context"
grep -r "\.values(" --include="*.cpp" --include="*.h" | grep -v "algorithm_context"
grep -r "\.clear()" --include="*.cpp" --include="*.h" | grep -v "algorithm_context"
```

---

#### æ¨¡å—B: AlgorithmManagerï¼ˆ1ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | ä½ç½® | è¡Œæ•° | åˆ é™¤ç†ç”± |
|---------|------|------|----------|
| `executeWithContext(const QString&, AlgorithmContext*)` | algorithm_manager.h:56 | ~68 | å·²è¢«å¼‚æ­¥ç‰ˆæœ¬ `executeAsync()` å®Œå…¨æ›¿ä»£ |

**åˆ é™¤ä½ç½®**:
```
Analysis/src/application/algorithm/algorithm_manager.h: ç¬¬56è¡Œ
Analysis/src/application/algorithm/algorithm_manager.cpp: ç¬¬53-120è¡Œ
```

**éªŒè¯å‘½ä»¤**:
```bash
grep -r "executeWithContext" --include="*.cpp" --include="*.h" | grep -v "algorithm_manager"
```

---

#### æ¨¡å—C: HistoryManagerï¼ˆ2ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | ä½ç½® | è¡Œæ•° | åˆ é™¤ç†ç”± |
|---------|------|------|----------|
| `undoCount() const` | history_manager.h | ~3 | ä¸ `canUndo()` åŠŸèƒ½é‡å¤ |
| `redoCount() const` | history_manager.h | ~3 | ä¸ `canRedo()` åŠŸèƒ½é‡å¤ |

**åˆ é™¤ä½ç½®**:
```
Analysis/src/application/history/history_manager.h: æŸ¥æ‰¾å¹¶åˆ é™¤å£°æ˜
Analysis/src/application/history/history_manager.cpp: æŸ¥æ‰¾å¹¶åˆ é™¤å®ç°
```

**éªŒè¯å‘½ä»¤**:
```bash
grep -r "undoCount()" --include="*.cpp" --include="*.h"
grep -r "redoCount()" --include="*.cpp" --include="*.h"
```

---

#### æ¨¡å—D: AlgorithmResultï¼ˆ9ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | ä½ç½® | è¡Œæ•° | åˆ é™¤ç†ç”± |
|---------|------|------|----------|
| `addCurve(const ThermalCurve&)` | algorithm_result.h | ~5 | ç”¨ `setCurve()` æ›¿ä»£ |
| `primaryCurve() const` | algorithm_result.h | ~5 | ç”¨ `curves()` + æ£€æŸ¥æ›¿ä»£ |
| `setMarkers(const QList<QPointF>&)` | algorithm_result.h | ~5 | ç”¨ `addMarker()` æ›¿ä»£ |
| `setRegions(const QList<QPolygonF>&)` | algorithm_result.h | ~5 | å¾…å®ç°åŠŸèƒ½ |
| `regions() const` | algorithm_result.h | ~5 | å¾…å®ç°åŠŸèƒ½ |
| `setPeakPosition(const QPointF&)` | algorithm_result.h | ~5 | ç”¨ `setMeta()` æ›¿ä»£ |
| `peakPosition() const` | algorithm_result.h | ~5 | ç”¨ `metaValue()` æ›¿ä»£ |
| `signalType() const` | algorithm_result.h | ~5 | ç”¨ `metaValue()` æ›¿ä»£ |
| `OutputKeys::historyResult(const QString&, int)` | algorithm_result.h | ~5 | å¾…å®ç°åŠŸèƒ½ |

**åˆ é™¤ä½ç½®**:
```
Analysis/src/domain/algorithm/algorithm_result.h: æŸ¥æ‰¾å¹¶åˆ é™¤æ‰€æœ‰å£°æ˜
Analysis/src/domain/algorithm/algorithm_result.cpp: æŸ¥æ‰¾å¹¶åˆ é™¤æ‰€æœ‰å®ç°
```

---

#### æ¨¡å—E: ThermalCurveï¼ˆ4ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | ä½ç½® | è¡Œæ•° | åˆ é™¤ç†ç”± |
|---------|------|------|----------|
| `plotStyle() const` | thermal_curve.h:84 | ~3 | UIæ ·å¼ä¸åº”åœ¨æ•°æ®æ¨¡å‹å±‚ |
| `setPlotStyle(PlotStyle)` | thermal_curve.h:98 | ~3 | UIæ ·å¼ä¸åº”åœ¨æ•°æ®æ¨¡å‹å±‚ |
| `setName(const QString&)` | thermal_curve.h:90 | ~3 | æ›²çº¿åç§°é€šè¿‡æ„é€ å‡½æ•°è®¾ç½®ï¼Œæ— éœ€setter |
| `resetToRaw()` | thermal_curve.h:119 | ~5 | åŠŸèƒ½è¢« HistoryManager æ’¤é”€æœºåˆ¶æ›¿ä»£ |

**åˆ é™¤ä½ç½®**:
```
Analysis/src/domain/model/thermal_curve.h: ç¬¬84, 90, 98, 119è¡Œ
Analysis/src/domain/model/thermal_curve.cpp: ç¬¬44, 52, 72, 80è¡Œ
```

---

#### æ¨¡å—F: BaselineCorrectionAlgorithmï¼ˆ1ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | ä½ç½® | è¡Œæ•° | åˆ é™¤ç†ç”± |
|---------|------|------|----------|
| `findNearestPoint(const QVector<ThermalDataPoint>&, double) const` | baseline_correction_algorithm.h:63 | ~21 | æ—©æœŸè®¾è®¡é—ç•™ï¼Œå®é™…ç®—æ³•ä¸ä½¿ç”¨ |

**åˆ é™¤ä½ç½®**:
```
Analysis/src/infrastructure/algorithm/baseline_correction_algorithm.h: ç¬¬63è¡Œ
Analysis/src/infrastructure/algorithm/baseline_correction_algorithm.cpp: ç¬¬266-286è¡Œ
```

---

#### æ¨¡å—G: ChartViewï¼ˆ2ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | ä½ç½® | è¡Œæ•° | åˆ é™¤ç†ç”± |
|---------|------|------|----------|
| `selectedPoints() const` | chart_view.h | ~3 | å®Œå…¨å†—ä½™ |
| `selectedPointsCurveId() const` | chart_view.h | ~3 | å®Œå…¨å†—ä½™ |

**åˆ é™¤ä½ç½®**:
```
Analysis/src/ui/chart_view.h: æŸ¥æ‰¾å¹¶åˆ é™¤å£°æ˜
Analysis/src/ui/chart_view.cpp: æŸ¥æ‰¾å¹¶åˆ é™¤å®ç°
```

---

#### æ¨¡å—H: ThermalChartï¼ˆ4ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | ä½ç½® | è¡Œæ•° | åˆ é™¤ç†ç”± |
|---------|------|------|----------|
| `toggleXAxisMode()` | thermal_chart.h:76 | ~5 | åªæ˜¯ `setXAxisMode()` çš„ä¾¿æ·åŒ…è£…ï¼ŒåŠŸèƒ½é‡å¤ |
| `rescaleYAxisForXRange(...)` | thermal_chart.h:206 | ~42 | æ¡†é€‰ç¼©æ”¾åŠŸèƒ½å·²é€šè¿‡å…¶ä»–æ–¹å¼å®ç° |
| `point1() const` | thermal_chart.h | ~3 | æœªä½¿ç”¨çš„getter |
| `point2() const` | thermal_chart.h | ~3 | æœªä½¿ç”¨çš„getter |

**åˆ é™¤ä½ç½®**:
```
Analysis/src/ui/thermal_chart.h: ç¬¬76, 206è¡ŒåŠç›¸å…³getter
Analysis/src/ui/thermal_chart.cpp: ç¬¬646-650, 1048-1089è¡ŒåŠç›¸å…³å®ç°
```

---

#### æ¨¡å—I: PeakAreaToolï¼ˆ3ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | ä½ç½® | è¡Œæ•° | åˆ é™¤ç†ç”± |
|---------|------|------|----------|
| `point1() const` | peak_area_tool.h:108 | ~3 | æœªä½¿ç”¨çš„getterï¼Œå†…éƒ¨ç›´æ¥è®¿é—®æˆå‘˜ |
| `point2() const` | peak_area_tool.h:113 | ~3 | æœªä½¿ç”¨çš„getterï¼Œå†…éƒ¨ç›´æ¥è®¿é—®æˆå‘˜ |
| `areaPolygon() const` | peak_area_tool.h:128 | ~3 | æœªä½¿ç”¨çš„getterï¼Œæš´éœ²å†…éƒ¨æ•°æ®ç»“æ„ |

**åˆ é™¤ä½ç½®**:
```
Analysis/src/ui/peak_area_tool.h: ç¬¬105-128è¡Œ
```

---

#### æ¨¡å—J: TrapezoidMeasureToolï¼ˆ3ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | ä½ç½® | è¡Œæ•° | åˆ é™¤ç†ç”± |
|---------|------|------|----------|
| `point1() const` | trapezoid_measure_tool.h:81 | ~3 | æœªä½¿ç”¨çš„getter |
| `point2() const` | trapezoid_measure_tool.h:86 | ~3 | æœªä½¿ç”¨çš„getter |
| `updatePosition()` | trapezoid_measure_tool.h:143 | ~5 | å­¤ç«‹çš„slotï¼Œæ— ä¿¡å·è¿æ¥ |

**åˆ é™¤ä½ç½®**:
```
Analysis/src/ui/trapezoid_measure_tool.h: ç¬¬78-86, 140-143è¡Œ
Analysis/src/ui/trapezoid_measure_tool.cpp: ç¬¬397-401è¡Œ
```

---

### Priority 2: å»ºè®®ä¿ç•™ï¼ˆè®¾è®¡å®Œæ•´æ€§ï¼‰âš ï¸

è¿™äº›å‡½æ•°è™½æœªä½¿ç”¨ï¼Œä½†å‡ºäºè®¾è®¡å®Œæ•´æ€§ã€APIä¸€è‡´æ€§æˆ–æœªæ¥æ‰©å±•æ€§è€ƒè™‘ï¼Œå»ºè®®ä¿ç•™ã€‚

#### HistoryManagerï¼ˆ2ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | ä¿ç•™ç†ç”± |
|---------|----------|
| `setHistoryLimit(int)` | å…¬å…±é…ç½®APIï¼Œè™½å½“å‰ä½¿ç”¨é»˜è®¤å€¼ï¼Œä½†åº”ä¿ç•™é…ç½®èƒ½åŠ› |
| `historyLimit() const` | ä¸ setter é…å¯¹çš„ getterï¼Œç¬¦åˆ Qt å±æ€§æ¨¡å¼ |

#### AlgorithmResultï¼ˆ2ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | ä¿ç•™ç†ç”± |
|---------|----------|
| `algorithmKey() const` | æ ¸å¿ƒå…ƒæ•°æ®ï¼Œç”¨äºç»“æœè¿½è¸ªå’Œå”¯ä¸€æ ‡è¯† |
| `timestamp() const` | å®¡è®¡è¿½è¸ªï¼Œè®°å½•ç®—æ³•æ‰§è¡Œæ—¶é—´ |

#### ThermalCurveï¼ˆ1ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | ä¿ç•™ç†ç”± |
|---------|----------|
| `getRawData() const` | APIå¯¹ç§°æ€§è®¾è®¡ï¼Œä¸ `setRawData()` é…å¯¹ |

#### ThermalChartï¼ˆ5ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | ä¿ç•™ç†ç”± |
|---------|----------|
| `setCustomTitles(...)` | å®Œæ•´çš„APIè®¾è®¡ï¼Œæœªæ¥å¯èƒ½éœ€è¦ |
| `clearCustomTitles()` | ä¸ setter é…å¯¹ï¼Œä¿æŒAPIå®Œæ•´æ€§ |
| `primaryAxisY() const` | æ ‡å‡†public getterï¼Œæš´éœ²å†…éƒ¨çŠ¶æ€ |
| `secondaryAxisY() const` | æ ‡å‡†public getterï¼Œæš´éœ²å†…éƒ¨çŠ¶æ€ |
| `thermalChart() const` | ThermalChartViewçš„æ ‡å‡†getter |

---

### Priority 3: å¾…è¯„ä¼°ï¼ˆéœ€è¿›ä¸€æ­¥ç¡®è®¤ï¼‰ğŸ”„

#### AlgorithmCoordinatorï¼ˆ1ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | è¯„ä¼°ç†ç”± |
|---------|----------|
| `handleParameterSubmission(const QString&, const QVariantMap&)` | å®éªŒæ€§æ¶æ„çš„ä¸€éƒ¨åˆ†ï¼Œä¸ºå°†æ¥å‚æ•°å¯¹è¯æ¡†åŠŸèƒ½é¢„ç•™ã€‚éœ€è¦åœ¨å®ç°å‚æ•°å¯¹è¯æ¡†UIåé‡æ–°è¯„ä¼°ã€‚ |

**å»ºè®®**: ä¿ç•™è‡³ Phase 3ï¼ˆç®—æ³•æ‰©å±•é˜¶æ®µï¼‰å®Œæˆåå†è¯„ä¼°ã€‚

#### ChartViewï¼ˆ4ä¸ªå‡½æ•°ï¼‰

| å‡½æ•°ç­¾å | è¯„ä¼°ç†ç”± |
|---------|----------|
| `verticalCrosshairEnabled() const` | æŸ¥è¯¢å™¨ï¼Œå¯èƒ½åœ¨æœªæ¥éœ€è¦ |
| `horizontalCrosshairEnabled() const` | æŸ¥è¯¢å™¨ï¼Œå¯èƒ½åœ¨æœªæ¥éœ€è¦ |
| `interactionState() const` | ä¿¡å·é©±åŠ¨æ¶æ„ä¸­å¯èƒ½å†—ä½™ |
| `activeAlgorithm() const` | å¯èƒ½åœ¨æœªæ¥äº¤äº’æµç¨‹ä¸­éœ€è¦ |

**å»ºè®®**: åœ¨åŸºçº¿æ ¡æ­£åŠŸèƒ½å®Œå…¨å®ç°åé‡æ–°è¯„ä¼°ã€‚

---

<a name="-åˆ†é˜¶æ®µåˆ é™¤è®¡åˆ’"></a>
## ğŸ“ åˆ†é˜¶æ®µåˆ é™¤è®¡åˆ’

### Phase 1: ä½é£é™©åˆ é™¤ï¼ˆç¬¬1å‘¨ï¼‰

**ç›®æ ‡**: åˆ é™¤å®Œå…¨æœªä½¿ç”¨ä¸”æ— ä»»ä½•ä¾èµ–çš„å‡½æ•°

**èŒƒå›´**:
- AlgorithmContext: 3ä¸ªå‡½æ•°
- AlgorithmManager: 1ä¸ªå‡½æ•°
- HistoryManager: 2ä¸ªå‡½æ•°ï¼ˆundoCount/redoCountï¼‰
- BaselineCorrectionAlgorithm: 1ä¸ªå‡½æ•°

**é¢„æœŸæ”¶ç›Š**: åˆ é™¤çº¦120è¡Œä»£ç 

**æ‰§è¡Œæ­¥éª¤**:
1. å¤‡ä»½å½“å‰ä»£ç ï¼ˆåˆ›å»ºgitåˆ†æ”¯ï¼‰
2. é€ä¸ªåˆ é™¤å‡½æ•°
3. æ¯åˆ é™¤ä¸€ä¸ªæ¨¡å—åç¼–è¯‘éªŒè¯
4. è¿è¡ŒåŸºæœ¬åŠŸèƒ½æµ‹è¯•
5. æäº¤åˆ°ç‹¬ç«‹åˆ†æ”¯

**éªŒè¯æ¸…å•**:
- [ ] ç¼–è¯‘æ— é”™è¯¯
- [ ] æ‰€æœ‰ç°æœ‰æµ‹è¯•é€šè¿‡
- [ ] åŸºçº¿æ ¡æ­£ç®—æ³•åŠŸèƒ½æ­£å¸¸
- [ ] ç®—æ³•æ‰§è¡Œæµç¨‹æ­£å¸¸

---

### Phase 2: ä¸­ç­‰é£é™©åˆ é™¤ï¼ˆç¬¬2å‘¨ï¼‰

**ç›®æ ‡**: åˆ é™¤æ•°æ®æ¨¡å‹å’Œå·¥å…·ç±»ä¸­çš„æœªä½¿ç”¨æ–¹æ³•

**èŒƒå›´**:
- ThermalCurve: 4ä¸ªå‡½æ•°
- AlgorithmResult: 9ä¸ªå‡½æ•°
- PeakAreaTool: 3ä¸ªå‡½æ•°
- TrapezoidMeasureTool: 3ä¸ªå‡½æ•°

**é¢„æœŸæ”¶ç›Š**: åˆ é™¤çº¦120è¡Œä»£ç 

**æ‰§è¡Œæ­¥éª¤**:
1. ä»Phase 1åˆ†æ”¯åˆ›å»ºPhase 2åˆ†æ”¯
2. å…ˆåˆ é™¤å·¥å…·ç±»å‡½æ•°ï¼ˆé£é™©æœ€ä½ï¼‰
3. å†åˆ é™¤æ•°æ®æ¨¡å‹å‡½æ•°
4. å…¨é¢å›å½’æµ‹è¯•
5. åˆå¹¶åˆ°Phase 1åˆ†æ”¯

**éªŒè¯æ¸…å•**:
- [ ] ç¼–è¯‘æ— é”™è¯¯
- [ ] æ‰€æœ‰æµ‹é‡å·¥å…·åŠŸèƒ½æ­£å¸¸
- [ ] æ›²çº¿åˆ›å»ºå’Œç®¡ç†æ­£å¸¸
- [ ] ç®—æ³•ç»“æœå¤„ç†æ­£å¸¸

---

### Phase 3: UIå±‚åˆ é™¤ï¼ˆç¬¬3å‘¨ï¼‰

**ç›®æ ‡**: åˆ é™¤å›¾è¡¨å’Œè§†å›¾ç±»ä¸­çš„æœªä½¿ç”¨æ–¹æ³•

**èŒƒå›´**:
- ChartView: 2ä¸ªå‡½æ•°ï¼ˆselectedPointsç›¸å…³ï¼‰
- ThermalChart: 4ä¸ªå‡½æ•°

**é¢„æœŸæ”¶ç›Š**: åˆ é™¤çº¦80è¡Œä»£ç 

**æ‰§è¡Œæ­¥éª¤**:
1. ä»Phase 2åˆ†æ”¯åˆ›å»ºPhase 3åˆ†æ”¯
2. åˆ é™¤ChartViewå†—ä½™å‡½æ•°
3. åˆ é™¤ThermalChartæœªä½¿ç”¨å‡½æ•°
4. å®Œæ•´UIäº¤äº’æµ‹è¯•
5. åˆå¹¶åˆ°ä¸»å¼€å‘åˆ†æ”¯

**éªŒè¯æ¸…å•**:
- [ ] ç¼–è¯‘æ— é”™è¯¯
- [ ] æ‰€æœ‰å›¾è¡¨äº¤äº’æ­£å¸¸ï¼ˆç¼©æ”¾ã€å¹³ç§»ã€é€‰ç‚¹ï¼‰
- [ ] æ¨ªè½´åˆ‡æ¢åŠŸèƒ½æ­£å¸¸
- [ ] å¤šYè½´åŠŸèƒ½æ­£å¸¸
- [ ] æµ‹é‡å·¥å…·åŠŸèƒ½æ­£å¸¸

---

### Phase 4: å¾…è¯„ä¼°å‡½æ•°å¤å®¡ï¼ˆåŸºçº¿æ ¡æ­£åŠŸèƒ½å®Œæˆåï¼‰

**ç›®æ ‡**: åœ¨åŸºçº¿æ ¡æ­£å’Œå‚æ•°å¯¹è¯æ¡†åŠŸèƒ½å®Œæˆåï¼Œé‡æ–°è¯„ä¼°å¾…è¯„ä¼°å‡½æ•°

**èŒƒå›´**:
- AlgorithmCoordinator: 1ä¸ªå‡½æ•°
- ChartView: 4ä¸ªå‡½æ•°

**æ‰§è¡Œç­–ç•¥**: å¾…åŠŸèƒ½å®ç°å®Œæˆåå†³å®š

---

<a name="-åˆ é™¤æ“ä½œæŒ‡å—"></a>
## ğŸ”§ åˆ é™¤æ“ä½œæŒ‡å—

### åˆ é™¤å‰æ£€æŸ¥æ¸…å•

åœ¨åˆ é™¤ä»»ä½•å‡½æ•°ä¹‹å‰ï¼Œå¿…é¡»å®Œæˆä»¥ä¸‹æ£€æŸ¥ï¼š

- [ ] **å…¨æ–‡æœç´¢éªŒè¯**: ä½¿ç”¨grepç¡®è®¤å‡½æ•°0æ¬¡è°ƒç”¨
  ```bash
  grep -r "\.functionName(" --include="*.cpp" --include="*.h"
  ```

- [ ] **å¤´æ–‡ä»¶æ£€æŸ¥**: ç¡®è®¤ä¸æ˜¯è™šå‡½æ•°æˆ–æ¥å£æ–¹æ³•çš„å®ç°
  ```bash
  grep -A 5 "functionName" header_file.h
  ```

- [ ] **Qtå…ƒå¯¹è±¡æ£€æŸ¥**: ç¡®è®¤ä¸æ˜¯Qtå±æ€§æˆ–ä¿¡å·æ§½
  ```bash
  grep -B 3 "functionName" header_file.h
  ```

- [ ] **æ³¨é‡Šæ£€æŸ¥**: æŸ¥çœ‹å‡½æ•°æ³¨é‡Šï¼Œäº†è§£è®¾è®¡æ„å›¾

- [ ] **Gitå†å²æ£€æŸ¥**: æŸ¥çœ‹å‡½æ•°çš„ä¿®æ”¹å†å²
  ```bash
  git log --all --oneline -- "**/filename.cpp" | grep functionName
  ```

---

### åˆ é™¤æ­¥éª¤æ¨¡æ¿

å¯¹äºæ¯ä¸ªè¦åˆ é™¤çš„å‡½æ•°ï¼š

1. **åˆ›å»ºå¤‡ä»½åˆ†æ”¯**
   ```bash
   git checkout -b cleanup/remove-unused-function-MODULE
   ```

2. **åˆ é™¤å£°æ˜**ï¼ˆå¤´æ–‡ä»¶ï¼‰
   - åˆ é™¤å‡½æ•°å£°æ˜è¡Œ
   - åˆ é™¤ç›¸å…³æ³¨é‡Šæ–‡æ¡£

3. **åˆ é™¤å®ç°**ï¼ˆæºæ–‡ä»¶ï¼‰
   - åˆ é™¤å®Œæ•´çš„å‡½æ•°å®ç°
   - åŒ…æ‹¬å¼€å¤´çš„æ³¨é‡Š

4. **ç¼–è¯‘éªŒè¯**
   ```bash
   cd Analysis
   rebuild.bat
   ```

5. **åŠŸèƒ½æµ‹è¯•**
   - å¯åŠ¨åº”ç”¨ç¨‹åº
   - æµ‹è¯•ç›¸å…³åŠŸèƒ½æ¨¡å—
   - ç¡®è®¤æ— è¿è¡Œæ—¶é”™è¯¯

6. **æäº¤æ›´æ”¹**
   ```bash
   git add .
   git commit -m "åˆ é™¤æœªä½¿ç”¨å‡½æ•°: MODULE::functionName

   - ä½ç½®: file.h:è¡Œå·
   - ç†ç”±: [åˆ é™¤ç†ç”±]
   - éªŒè¯: ç¼–è¯‘é€šè¿‡ï¼ŒåŠŸèƒ½æµ‹è¯•æ­£å¸¸
   "
   ```

---

### æ‰¹é‡åˆ é™¤è„šæœ¬ç¤ºä¾‹

```bash
#!/bin/bash
# æ‰¹é‡åˆ é™¤ AlgorithmContext æœªä½¿ç”¨å‡½æ•°

echo "å¼€å§‹åˆ é™¤ AlgorithmContext æœªä½¿ç”¨å‡½æ•°..."

# å¤‡ä»½
git checkout -b cleanup/algorithm-context-unused

# éªŒè¯å½“å‰æ— è°ƒç”¨
echo "éªŒè¯ value() è°ƒç”¨..."
grep -r "\.value(" --include="*.cpp" --include="*.h" | grep -v "algorithm_context"

echo "éªŒè¯ values() è°ƒç”¨..."
grep -r "\.values(" --include="*.cpp" --include="*.h" | grep -v "algorithm_context"

echo "éªŒè¯ clear() è°ƒç”¨..."
grep -r "\.clear()" --include="*.cpp" --include="*.h" | grep -v "algorithm_context"

# ç­‰å¾…ç”¨æˆ·ç¡®è®¤
read -p "éªŒè¯é€šè¿‡ï¼Œæ˜¯å¦ç»§ç»­åˆ é™¤ï¼Ÿ(y/n) " -n 1 -r
echo
if [[ ! $REPLY =~ ^[Yy]$ ]]
then
    exit 1
fi

# æ‰§è¡Œåˆ é™¤ï¼ˆæ‰‹åŠ¨æ“ä½œï¼Œè„šæœ¬ä»…æç¤ºï¼‰
echo "è¯·æ‰‹åŠ¨æ‰§è¡Œä»¥ä¸‹åˆ é™¤æ“ä½œï¼š"
echo "1. ç¼–è¾‘ algorithm_context.h: åˆ é™¤ç¬¬313, 358, 372è¡Œ"
echo "2. ç¼–è¾‘ algorithm_context.cpp: åˆ é™¤ç¬¬12-15, 42-52, 69-78è¡Œ"
echo "3. ç¼–è¯‘éªŒè¯: rebuild.bat"
echo "4. æäº¤: git add . && git commit -m 'åˆ é™¤AlgorithmContextæœªä½¿ç”¨å‡½æ•°'"
```

---

## âš ï¸ é£é™©è¯„ä¼°ä¸ç¼“è§£æªæ–½

### é£é™©çŸ©é˜µ

| é£é™©ç±»å‹ | æ¦‚ç‡ | å½±å“ | ç¼“è§£æªæ–½ |
|---------|------|------|----------|
| ç¼–è¯‘å¤±è´¥ | ä½ | ä¸­ | åˆ†é˜¶æ®µåˆ é™¤ï¼Œæ¯æ¬¡ç¼–è¯‘éªŒè¯ |
| è¿è¡Œæ—¶é”™è¯¯ | æä½ | é«˜ | å…¨é¢åŠŸèƒ½æµ‹è¯•ï¼Œå›å½’æµ‹è¯• |
| éšè—ä¾èµ– | ä½ | ä¸­ | å…¨æ–‡æœç´¢éªŒè¯ï¼ŒGitå†å²æ£€æŸ¥ |
| æœªæ¥åŠŸèƒ½éœ€æ±‚ | ä¸­ | ä½ | ä¿ç•™å®Œæ•´çš„Gitå†å²ï¼Œå¯éšæ—¶æ¢å¤ |

### ç¼“è§£æªæ–½æ¸…å•

1. **ç‰ˆæœ¬æ§åˆ¶ä¿æŠ¤**
   - æ‰€æœ‰åˆ é™¤æ“ä½œåœ¨ç‹¬ç«‹åˆ†æ”¯è¿›è¡Œ
   - æ¯ä¸ªé˜¶æ®µå•ç‹¬æäº¤
   - ä¿ç•™å®Œæ•´çš„Gitå†å²

2. **éªŒè¯æœºåˆ¶**
   - ç¼–è¯‘éªŒè¯ï¼ˆæ¯æ¬¡åˆ é™¤åï¼‰
   - åŠŸèƒ½æµ‹è¯•ï¼ˆæ¯ä¸ªæ¨¡å—åï¼‰
   - å›å½’æµ‹è¯•ï¼ˆæ¯ä¸ªé˜¶æ®µåï¼‰

3. **å›é€€æœºåˆ¶**
   ```bash
   # å¦‚æœå‘ç°é—®é¢˜ï¼Œå¯ç«‹å³å›é€€
   git checkout main
   git branch -D cleanup/xxx
   ```

4. **æ–‡æ¡£è®°å½•**
   - è®°å½•æ¯ä¸ªåˆ é™¤å†³ç­–
   - ä¿ç•™å‡½æ•°çš„åŸå§‹è®¾è®¡æ„å›¾
   - æ–‡æ¡£åŒ–åˆ é™¤ç†ç”±

---

<a name="-åˆ†ææ–¹æ³•è®º"></a>
## ğŸ” åˆ†ææ–¹æ³•è®º

### ä½¿ç”¨çš„å·¥å…·å’ŒæŠ€æœ¯

1. **é™æ€ä»£ç åˆ†æ**
   - ä½¿ç”¨grepå…¨æ–‡æœç´¢éªŒè¯è°ƒç”¨æƒ…å†µ
   - æ£€æŸ¥å¤´æ–‡ä»¶å’Œæºæ–‡ä»¶çš„å£°æ˜ä¸å®ç°

2. **Gitå†å²åˆ†æ**
   - æŸ¥çœ‹å‡½æ•°çš„ä¿®æ”¹å†å²
   - äº†è§£å‡½æ•°çš„è®¾è®¡æ„å›¾

3. **æ¶æ„åˆ†æ**
   - æ£€æŸ¥å‡½æ•°æ˜¯å¦ç¬¦åˆåˆ†å±‚æ¶æ„
   - è¯„ä¼°å‡½æ•°åœ¨æ•´ä½“è®¾è®¡ä¸­çš„ä½œç”¨

4. **é£é™©è¯„ä¼°**
   - ç¼–è¯‘ä¾èµ–åˆ†æ
   - è¿è¡Œæ—¶ä¾èµ–åˆ†æ
   - æœªæ¥éœ€æ±‚è¯„ä¼°

### åˆ†ææµç¨‹

```
åŸå§‹åˆ—è¡¨ï¼ˆæœªä½¿ç”¨å‡½æ•°æ•´ç†.mdï¼‰
    â†“
æ¨¡å—åˆ†ç±»ï¼ˆ6ä¸ªä¸»è¦æ¨¡å—ï¼‰
    â†“
é€ä¸ªåˆ†æï¼ˆä½¿ç”¨Task Agentï¼‰
    â”œâ”€ å…¨æ–‡æœç´¢è°ƒç”¨æƒ…å†µ
    â”œâ”€ æ£€æŸ¥Qtå…ƒå¯¹è±¡ç‰¹æ€§
    â”œâ”€ åˆ†æè®¾è®¡æ„å›¾
    â””â”€ è¯„ä¼°åˆ é™¤é£é™©
    â†“
åˆ†ç±»å†³ç­–
    â”œâ”€ å¯åˆ é™¤ï¼ˆ27ä¸ªï¼‰
    â”œâ”€ å»ºè®®ä¿ç•™ï¼ˆ10ä¸ªï¼‰
    â””â”€ å¾…è¯„ä¼°ï¼ˆ5ä¸ªï¼‰
    â†“
ç”Ÿæˆåˆ é™¤è®¡åˆ’
    â”œâ”€ ä¸‰é˜¶æ®µæ‰§è¡Œè®¡åˆ’
    â”œâ”€ æ“ä½œæŒ‡å—
    â””â”€ éªŒè¯æ¸…å•
```

---

<a name="-ç»éªŒæ•™è®­"></a>
## ğŸ“ ç»éªŒæ•™è®­

### è®¾è®¡é—®é¢˜æ´å¯Ÿ

#### é—®é¢˜1: è¿‡åº¦è®¾è®¡ï¼ˆOver-Engineeringï¼‰

**è¡¨ç°**:
- æä¾›äº†å¤šä¸ªåŠŸèƒ½é‡å¤çš„æ¥å£ï¼ˆvalue/get, undoCount/canUndoï¼‰
- è®¾è®¡äº†æœªæ¥å¯èƒ½éœ€è¦çš„åŠŸèƒ½ï¼ˆsetRegions, historyResultï¼‰

**å½±å“**:
- å¢åŠ APIå¤æ‚åº¦
- æé«˜ç»´æŠ¤æˆæœ¬
- å¯èƒ½è¯¯å¯¼ä½¿ç”¨è€…

**å»ºè®®**:
- éµå¾ªYAGNIåŸåˆ™ï¼ˆYou Aren't Gonna Need Itï¼‰
- åªå®ç°å½“å‰éœ€è¦çš„åŠŸèƒ½
- é€šè¿‡è¿­ä»£é€æ­¥æ‰©å±•

---

#### é—®é¢˜2: å±‚æ¬¡èŒè´£æ··æ·†

**è¡¨ç°**:
- ThermalCurveï¼ˆé¢†åŸŸæ¨¡å‹å±‚ï¼‰åŒ…å«plotStyleï¼ˆè¡¨ç¤ºå±‚å…³æ³¨ç‚¹ï¼‰

**å½±å“**:
- è¿ååˆ†å±‚æ¶æ„åŸåˆ™
- å¢åŠ æ¨¡å—è€¦åˆ

**å»ºè®®**:
- ä¸¥æ ¼éµå¾ªå››å±‚æ¶æ„
- è¡¨ç¤ºå±‚å…³æ³¨ç‚¹åº”åœ¨UIå±‚å®ç°

---

#### é—®é¢˜3: APIè®¾è®¡ä¸ä¸€è‡´

**è¡¨ç°**:
- åŒæ—¶æä¾›value(key)å’Œget<T>(key)ä¸¤ç§æ–¹å¼
- åŒæ—¶æä¾›toggleXAxisMode()å’ŒsetXAxisMode()

**å½±å“**:
- ä½¿ç”¨è€…å›°æƒ‘ï¼šè¯¥ç”¨å“ªä¸ªï¼Ÿ
- ä»£ç å®¡æŸ¥å›°éš¾

**å»ºè®®**:
- ç»Ÿä¸€æ¥å£é£æ ¼
- æ¯ä¸ªåŠŸèƒ½åªæä¾›ä¸€ç§æœ€ä½³æ–¹å¼

---

### è®¾è®¡åŸåˆ™

#### 1. è®¾è®¡é˜¶æ®µ

- âœ… **DO**: éµå¾ªYAGNIåŸåˆ™ï¼Œåªå®ç°å½“å‰éœ€è¦çš„åŠŸèƒ½
- âœ… **DO**: ç»Ÿä¸€APIé£æ ¼ï¼Œæ¯ä¸ªåŠŸèƒ½åªæä¾›ä¸€ç§æ–¹å¼
- âŒ **DON'T**: è¿‡åº¦è®¾è®¡æœªæ¥å¯èƒ½éœ€è¦çš„æ¥å£
- âŒ **DON'T**: æä¾›åŠŸèƒ½é‡å¤çš„å¤šä¸ªæ¥å£

#### 2. å®ç°é˜¶æ®µ

- âœ… **DO**: ä¸¥æ ¼éµå¾ªåˆ†å±‚æ¶æ„ï¼ŒèŒè´£æ¸…æ™°
- âœ… **DO**: ä¼˜å…ˆä½¿ç”¨ç±»å‹å®‰å…¨çš„æ¥å£ï¼ˆå¦‚get<T>è€Œévalueï¼‰
- âŒ **DON'T**: åœ¨é¢†åŸŸæ¨¡å‹å±‚æ·»åŠ è¡¨ç¤ºå±‚å…³æ³¨ç‚¹
- âŒ **DON'T**: å¯¹ç§°è®¾è®¡ï¼ˆæœ‰setterå°±è®¾è®¡getterï¼‰

#### 3. ç»´æŠ¤é˜¶æ®µ

- âœ… **DO**: å®šæœŸæ‰«æå’Œæ¸…ç†æœªä½¿ç”¨ä»£ç 
- âœ… **DO**: ä¿æŒGitå†å²å®Œæ•´ï¼Œæ–¹ä¾¿è¿½æº¯è®¾è®¡å†³ç­–
- âœ… **DO**: æ–‡æ¡£åŒ–é‡è¦çš„è®¾è®¡å†³ç­–
- âŒ **DON'T**: ä¿ç•™"å¯èƒ½å°†æ¥æœ‰ç”¨"çš„ä»£ç 

---

## ğŸ“‹ åç»­å»ºè®®

### ç«‹å³æ‰§è¡Œï¼ˆæœ¬å‘¨ï¼‰

1. **å¯åŠ¨Phase 1åˆ é™¤**
   - åˆ›å»ºcleanup/phase1åˆ†æ”¯
   - åˆ é™¤AlgorithmContextã€AlgorithmManagerç­‰ä½é£é™©å‡½æ•°
   - ç¼–è¯‘å’ŒåŠŸèƒ½éªŒè¯

2. **ä»£ç å®¡æŸ¥**
   - å®¡æŸ¥åˆ é™¤è®¡åˆ’æ–‡æ¡£
   - ç¡®è®¤åˆ†æç»“è®º
   - è®¨è®ºå¾…è¯„ä¼°å‡½æ•°çš„å¤„ç†ç­–ç•¥

---

### çŸ­æœŸä¼˜åŒ–ï¼ˆ2-3å‘¨ï¼‰

1. **æ‰§è¡Œå®Œæ•´åˆ é™¤è®¡åˆ’**
   - Phase 1: ä½é£é™©åˆ é™¤ï¼ˆç¬¬1å‘¨ï¼‰
   - Phase 2: ä¸­ç­‰é£é™©åˆ é™¤ï¼ˆç¬¬2å‘¨ï¼‰
   - Phase 3: UIå±‚åˆ é™¤ï¼ˆç¬¬3å‘¨ï¼‰

2. **ä»£ç è´¨é‡æ”¹è¿›**
   - å¯ç”¨ç¼–è¯‘å™¨è­¦å‘Šï¼š-Wunused-function
   - è¿è¡Œé™æ€åˆ†æå·¥å…·ï¼ˆclang-tidyï¼‰
   - æ›´æ–°CLAUDE.mdæ–‡æ¡£

---

### é•¿æœŸè§„åˆ’ï¼ˆPhase 4åï¼‰

1. **é‡æ–°è¯„ä¼°å¾…è¯„ä¼°å‡½æ•°**
   - åœ¨åŸºçº¿æ ¡æ­£åŠŸèƒ½å®Œæˆå
   - åœ¨å‚æ•°å¯¹è¯æ¡†UIå®ç°å
   - å†³å®šæœ€ç»ˆå¤„ç†æ–¹æ¡ˆ

2. **å»ºç«‹é¢„é˜²æœºåˆ¶**
   - CI/CDä¸­é›†æˆé™æ€åˆ†æ
   - å®šæœŸï¼ˆæ¯å­£åº¦ï¼‰è¿›è¡Œæœªä½¿ç”¨ä»£ç æ‰«æ
   - ä»£ç å®¡æŸ¥æ—¶å…³æ³¨APIè®¾è®¡

---

<a name="-é™„å½•"></a>
## ğŸ“š é™„å½•

### æ‰§è¡Œæ£€æŸ¥æ¸…å•

#### Phase 1 æ‰§è¡Œå‰

- [ ] åˆ›å»ºå¤‡ä»½åˆ†æ”¯: `git checkout -b cleanup/phase1-low-risk`
- [ ] ç¡®è®¤æ‰€æœ‰åˆ†ææŠ¥å‘Šå·²å®¡æŸ¥
- [ ] å‡†å¤‡å›å½’æµ‹è¯•ç¯å¢ƒ
- [ ] é€šçŸ¥å›¢é˜Ÿæˆå‘˜ï¼ˆå¦‚æœ‰ï¼‰

#### Phase 1 æ‰§è¡Œä¸­

- [ ] åˆ é™¤ AlgorithmContext 3ä¸ªå‡½æ•°
  - [ ] ç¼–è¯‘éªŒè¯
  - [ ] åŠŸèƒ½æµ‹è¯•
- [ ] åˆ é™¤ AlgorithmManager::executeWithContext
  - [ ] ç¼–è¯‘éªŒè¯
  - [ ] ç®—æ³•æ‰§è¡Œæµ‹è¯•
- [ ] åˆ é™¤ HistoryManager undoCount/redoCount
  - [ ] ç¼–è¯‘éªŒè¯
  - [ ] æ’¤é”€/é‡åšåŠŸèƒ½æµ‹è¯•
- [ ] åˆ é™¤ BaselineCorrectionAlgorithm::findNearestPoint
  - [ ] ç¼–è¯‘éªŒè¯
  - [ ] åŸºçº¿æ ¡æ­£ç®—æ³•æµ‹è¯•

#### Phase 1 æ‰§è¡Œå

- [ ] å®Œæ•´å›å½’æµ‹è¯•
- [ ] ä»£ç å®¡æŸ¥
- [ ] æäº¤å¹¶æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯
- [ ] åˆå¹¶åˆ°ä¸»åˆ†æ”¯ï¼ˆæˆ–ç­‰å¾…åç»­é˜¶æ®µï¼‰

---

### å‚è€ƒæ–‡æ¡£

#### é¡¹ç›®æ–‡æ¡£

- `CLAUDE.md` - é¡¹ç›®æ¶æ„å’Œè®¾è®¡åŸåˆ™
- `ARCHITECTURE_OPTIMIZATION_PLAN.md` - æ¶æ„ä¼˜åŒ–è·¯çº¿å›¾

#### ç”Ÿæˆçš„åˆ†ææŠ¥å‘Š

1. **æœªä½¿ç”¨å‡½æ•°è¯¦ç»†åˆ†ææŠ¥å‘Š.md** - HistoryManager/AlgorithmResultåˆ†æ
2. **æœªä½¿ç”¨å‡½æ•°åˆ é™¤å¯è¡Œæ€§åˆ†æ.md** - ThermalChart/CurveViewControlleråˆ†æ
3. **ChartView_å‡½æ•°ä½¿ç”¨åˆ†æ.md** - ChartViewäº¤äº’å·¥å…·åˆ†æ

---

### é—®é¢˜åé¦ˆ

å¦‚åœ¨æ‰§è¡Œåˆ é™¤è®¡åˆ’è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. **ç¼–è¯‘å¤±è´¥**: æ£€æŸ¥æ˜¯å¦æœ‰éšè—ä¾èµ–ï¼Œä½¿ç”¨Gitå›é€€
2. **æµ‹è¯•å¤±è´¥**: åˆ†æå¤±è´¥åŸå› ï¼Œå¯èƒ½éœ€è¦ä¿ç•™è¯¥å‡½æ•°
3. **è®¾è®¡ç–‘é—®**: å‚è€ƒCLAUDE.mdä¸­çš„æ¶æ„è®¾è®¡åŸåˆ™

---

## ğŸ“ æ›´æ–°è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ | ä½œè€… |
|------|------|----------|------|
| v1.0 | 2025-11-17 | åˆå§‹ç‰ˆæœ¬ï¼Œå®Œæˆå…¨ä»£ç åº“åˆ†æå¹¶æ•´åˆæ‰€æœ‰åˆ†ææ–‡æ¡£ | Claude Code |

---

**æ–‡æ¡£ç»“æŸ**

_æœ¬æ–‡æ¡£æ•´åˆäº†æ‰€æœ‰æœªä½¿ç”¨å‡½æ•°åˆ†æã€è¯„ä¼°å’Œåˆ é™¤è®¡åˆ’_
_ç”Ÿæˆå·¥å…·: Claude Code + Task Agent (Mediumæ¢ç´¢çº§åˆ«)_
_åˆ†ææ—¥æœŸ: 2025-11-17_
