graph TB
    subgraph è¡¨ç¤ºå±‚["ğŸ–¥ï¸ è¡¨ç¤ºå±‚ (Presentation Layer)"]
        direction TB
        MW[MainWindow<br/>ä¸»çª—å£]
        CV[ChartView<br/>å›¾è¡¨è§†å›¾]
        TP[ToolPanel<br/>å·¥å…·é¢æ¿]
        
        MW -.å‘å‡ºä¿¡å·.-> MW_Signal[ç”¨æˆ·æ“ä½œä¿¡å·:<br/>openFileRequested<br/>saveProjectRequested<br/>undoRequested]
        CV -.å‘å‡ºä¿¡å·.-> CV_Signal[äº¤äº’ä¿¡å·:<br/>regionSelected<br/>pointClicked<br/>zoomChanged]
        TP -.å‘å‡ºä¿¡å·.-> TP_Signal[å‚æ•°è®¾ç½®ä¿¡å·:<br/>parameterChanged<br/>algorithmApplied]
    end
    
    subgraph åº”ç”¨å±‚["âš™ï¸ åº”ç”¨å±‚ (Application Layer)"]
        direction TB
        
        subgraph Controllers["æ§åˆ¶å™¨ (Controllers)"]
            MC[MainController<br/>ä¸»æ§åˆ¶å™¨]
            CC[ChartController<br/>å›¾è¡¨æ§åˆ¶å™¨]
        end
        
        subgraph Services["æœåŠ¡å±‚ (Services)"]
            PM[ProjectManager<br/>é¡¹ç›®ç®¡ç†å™¨]
            CurveM[CurveManager<br/>æ›²çº¿ç®¡ç†å™¨]
            AS[AlgorithmService<br/>ç®—æ³•æœåŠ¡]
            HM[HistoryManager<br/>å†å²ç®¡ç†å™¨]
        end
    end
    
    subgraph é¢†åŸŸå±‚["ğŸ¯ é¢†åŸŸå±‚ (Domain Layer)"]
        direction TB
        
        subgraph DataModels["æ•°æ®æ¨¡å‹ (Data Models)"]
            TDP[ThermalDataPoint<br/>çƒ­åˆ†ææ•°æ®ç‚¹]
            TC[ThermalCurve<br/>çƒ­åˆ†ææ›²çº¿<br/><i>rawData / processedData</i>]
            TProj[ThermalProject<br/>çƒ­åˆ†æé¡¹ç›®]
        end
        
        subgraph AlgoInterfaces["ç®—æ³•æ¥å£ (Algorithm Interfaces)"]
            ITA[IThermalAlgorithm<br/>ç®—æ³•æ¥å£]
            ICmd[ICommand<br/>å‘½ä»¤æ¥å£]
        end
        
        TC -->|åŒ…å«å¤šä¸ª| TDP
        TProj -->|ç®¡ç†å¤šæ¡| TC
    end
    
    subgraph åŸºç¡€è®¾æ–½å±‚["ğŸ”§ åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer)"]
        direction TB
        
        subgraph FileIO["æ–‡ä»¶è¾“å…¥è¾“å‡º (FileIO)"]
            Reader[Reader<br/>æ–‡ä»¶è¯»å–å™¨<br/><i>å¤šæ ¼å¼æ”¯æŒ</i>]
            Writer[Writer<br/>æ–‡ä»¶å†™å…¥å™¨<br/><i>å¤šæ ¼å¼å¯¼å‡º</i>]
            Factory[FileReaderFactory<br/>æ–‡ä»¶å·¥å‚]
        end
        
        subgraph Algorithm["ç®—æ³•å®ç° (Algorithm)"]
            BC[BaselineCorrector<br/>åŸºçº¿æ ¡æ­£]
            SA[SmoothingAlgorithm<br/>å¹³æ»‘ç®—æ³•]
            PD[PeakDetector<br/>å³°å€¼æ£€æµ‹]
            Kinetics[KineticsAnalyzer<br/>åŠ¨åŠ›å­¦åˆ†æ]
        end
        
        subgraph Utility["å·¥å…·ç±» (Utility)"]
            DD[DataDecimator<br/>æ•°æ®æŠ½ç¨€<br/><i>Douglas-Peucker/LTTB</i>]
            DI[DataInterpolator<br/>æ•°æ®æ’å€¼]
            SC[StatisticsCalculator<br/>ç»Ÿè®¡è®¡ç®—]
        end
        
        Factory -->|åˆ›å»º| Reader
        Factory -->|åˆ›å»º| Writer
    end
    
    %% å±‚é—´ä¾èµ–å…³ç³»
    MW_Signal -->|ä¿¡å·æ§½è¿æ¥| MC
    CV_Signal -->|ä¿¡å·æ§½è¿æ¥| CC
    TP_Signal -->|ä¿¡å·æ§½è¿æ¥| MC
    
    MC -->|åè°ƒè°ƒç”¨| PM
    MC -->|åè°ƒè°ƒç”¨| CurveM
    MC -->|åè°ƒè°ƒç”¨| AS
    MC -->|åè°ƒè°ƒç”¨| HM
    CC -->|åè°ƒè°ƒç”¨| CurveM
    CC -->|åè°ƒè°ƒç”¨| AS
    
    PM -->|ç®¡ç†| TProj
    CurveM -->|ç®¡ç†| TC
    AS -->|è°ƒåº¦| ITA
    HM -->|æ‰§è¡Œ| ICmd
    
    BC -.å®ç°.-> ITA
    SA -.å®ç°.-> ITA
    PD -.å®ç°.-> ITA
    Kinetics -.å®ç°.-> ITA
    
    Reader -->|è§£æç”Ÿæˆ| TC
    Writer -->|å¯¼å‡º| TC
    
    AS -->|è°ƒç”¨å…·ä½“ç®—æ³•| BC
    AS -->|è°ƒç”¨å…·ä½“ç®—æ³•| SA
    AS -->|è°ƒç”¨å…·ä½“ç®—æ³•| PD
    AS -->|è°ƒç”¨å…·ä½“ç®—æ³•| Kinetics
    
    CV -->|ä½¿ç”¨å·¥å…·| DD
    CV -->|ä½¿ç”¨å·¥å…·| DI
    
    %% æ ·å¼å®šä¹‰
    classDef presentationStyle fill:#E3F2FD,stroke:#1976D2,stroke-width:2px,color:#000
    classDef applicationStyle fill:#F3E5F5,stroke:#7B1FA2,stroke-width:2px,color:#000
    classDef domainStyle fill:#FFF3E0,stroke:#F57C00,stroke-width:2px,color:#000
    classDef infrastructureStyle fill:#E8F5E9,stroke:#388E3C,stroke-width:2px,color:#000
    
    class MW,CV,TP,MW_Signal,CV_Signal,TP_Signal presentationStyle
    class MC,CC,PM,CurveM,AS,HM applicationStyle
    class TDP,TC,TProj,ITA,ICmd domainStyle
    class Reader,Writer,Factory,BC,SA,PD,Kinetics,DD,DI,SC infrastructureStyle
